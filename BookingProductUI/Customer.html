<!DOCTYPE html>
<html lang="en">
<head>
  <title>Customer | Book Products</title>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/css/bootstrap.min.css">
  <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.3/umd/popper.min.js"></script>
  <script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.1.3/js/bootstrap.min.js"></script>
<script>

function bookProduct(product, id) {
  var url = "http://localhost:51597/Products/"+product+"/Book/"+id;
   var xhttp = new XMLHttpRequest();
   xhttp.open("PUT", url, true);
   xhttp.onload = function () {
	if (xhttp.readyState == 4 && xhttp.status == "200") {
		console.log(xhttp.responseText);
	} else {
		console.log(xhttp.readyState);
	}
}
   xhttp.setRequestHeader('Content-type','application/json; charset=utf-8');
   xhttp.send();
}

function saveProduct(product,id) {
  var url = "http://localhost:51597/Products/"+product+"/Save/"+id;
   var xhttp = new XMLHttpRequest();
   xhttp.open("PUT", url, true);
   xhttp.onload = function () {
	if (xhttp.readyState == 4 && xhttp.status == "200") {
		console.log(xhttp.responseText);
	} else {
		console.log(xhttp.readyState);
	}
}
   xhttp.setRequestHeader('Content-type','application/json; charset=utf-8');
   xhttp.send();
}

function getAirList() {
  var hotelList;
  var xhttp = new XMLHttpRequest();
  var resultSection = document.getElementById("productList");
  resultSection.innerHTML = "";
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      resultSection.innerHTML = "<h1>Air Products</h1>";
      productList = JSON.parse(this.responseText);
      productList.forEach(product => {
            var content;
            content = 
            "<div style='margin:10px' class='card'>" +
                "<div class='row card-body'>" + 
                    "<div class='col'><h5 class='card-tittle'>" + product.Name + "</h5></div>" +
                    "<div class='col'>Departure Time: " + product.DepartureTime + "</div>" +
                    "<div class='col'>Arrival Time: " + product.ArrivalTime + "</div>" +
                    "<div class='col'>Duration: " + product.Duration +    "</div>" +
                    "<div class='col'>Price: " + product.Price +    "</div>";
                    if(!product.IsBooked) {
                      content += "<input style='margin:10px' class='col btn btn-primary' type='button' value='Book' onclick=\"bookProduct('Air',"+ product.Id + ")\" >"; 
                    }
                    else {
                      content += "<input style='margin:10px;' class='col btn btn-primary' type='button' value='Booked' onclick=\"bookProduct(\'Air\',"+ product.Id + ")\" disabled>"; 
                    }
                    if(!product.IsSaved) {
                      content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Save' onclick=\"saveProduct(\'Air\',"+ product.Id + ")\">";
                    }
                    else {
                     content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Saved' onclick=\"saveProduct(\'Air\',"+ product.Id + ")\" disabled>";
                    }
                "</div>" +
            "</div>"
            resultSection.innerHTML += content; 
      });
    }
  };
  xhttp.open("GET", "http://localhost:51597/Products/Air", true);
  xhttp.send();
}

function getCarList() {
  var xhttp = new XMLHttpRequest();
  var resultSection = document.getElementById("productList");
  resultSection.innerHTML = "";
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      resultSection.innerHTML = "<h1>Car Products</h1>";
      productList = JSON.parse(this.responseText);
      productList.forEach(product => {
        var content;
            content = 
            "<div style='margin:10px' class='card'>" +
                "<div   class='row card-body'>" + 
                    "<div class='col'><h5 class='card-tittle'>" + product.Name + "</h5></div>" +
                    "<div class='col'>Model: " + product.Model + "</div>" +
                    "<div class='col'>Company: " + product.Company + "</div>" +
                    "<div class='col'>Price: " + product.Price +    "</div>";
                      if(!product.IsBooked) {
                      content += "<input style='margin:10px' class='col btn btn-primary' type='button' value='Book' onclick=\"bookProduct('Car',"+ product.Id + ")\" >"; 
                    }
                    else {
                      content += "<input style='margin:10px;' class='col btn btn-primary' type='button' value='Booked' onclick=\"bookProduct(\'Car\',"+ product.Id + ")\" disabled>"; 
                    }
                    if(!product.IsSaved) {
                      content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Save' onclick=\"saveProduct(\'Car\',"+ product.Id + ")\">";
                    }
                    else {
                     content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Saved' onclick=\"saveProduct(\'Car\',"+ product.Id + ")\" disabled>";
                    }
                "</div>" +
            "</div>"
            resultSection.innerHTML += content; 
      });
    }
  };
  xhttp.open("GET", "http://localhost:51597/Products/Car", true);
  xhttp.send();
}
function getActivityList() {
  var xhttp = new XMLHttpRequest();
  var resultSection = document.getElementById("productList");
  resultSection.innerHTML = "";
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      resultSection.innerHTML = "<h1>Activity Products</h1>";
      productList = JSON.parse(this.responseText);
      productList.forEach(product => {
        var content;
            content = 
            "<div style='margin:10px' class='card'>" +
                "<div class='row card-body'>" + 
                    "<div class='col'><h5 class='card-tittle'>" + product.Name + "</h5></div>" +
                     "<div class='col'>From: " + product.FromTime + "</div>" +
                     "<div class='col'>To: " + product.ToTime + "</div>" +
                    "<div class='col'>Price: " + product.Price +    "</div>" +
                      "<div class='col'>Place: " + product.Place +    "</div>";
                    if(!product.IsBooked) {
                      content += "<input style='margin:10px' class='col btn btn-primary' type='button' value='Book' onclick=\"bookProduct(\'Activity\',"+ product.Id + ")\" >"; 
                    }
                    else {
                      content += "<input style='margin:10px;' class='col btn btn-primary' type='button' value='Booked' onclick=\"bookProduct(\'Activity\',"+ product.Id + ")\" disabled>"; 
                    }
                    if(!product.IsSaved) {
                      content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Save' onclick=\"saveProduct('Activity',"+ product.Id + ")\">";
                    }
                    else {
                     content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Saved' onclick=\"saveProduct(\'Activity\',"+ product.Id + ")\" disabled>";
                    }
                "</div>" +
            "</div>"
            resultSection.innerHTML += content; 
      });
    }
  };
  xhttp.open("GET", "http://localhost:51597/Products/Activity", true);
  xhttp.send();
}

function getHotelList() {
  var xhttp = new XMLHttpRequest();
  var resultSection = document.getElementById("productList");
  resultSection.innerHTML = "";
  xhttp.onreadystatechange = function() {
    if (this.readyState == 4 && this.status == 200) {
      resultSection.innerHTML = "<h1>Hotel Products</h1>";
      productList = JSON.parse(this.responseText);
      productList.forEach(product => {
        var content;
            content = 
            "<div style='margin:10px' class='card'>" +
                "<div class='row card-body'>" + 
                    "<div class='col'><h5 class='card-tittle'>" + product.Name + "</h5></div>" +
                    "<div class='col'>From: " + product.FromDate + "</div>" +
                    "<div class='col'>To: " + product.ToDate + "</div>" +
                    "<div class='col'>Price: " + product.Price +    "</div>" +
                    "<div class='col'>City: " + product.City +    "</div>" +
                    "<div class='col'>LandMark: " + product.LandMark +    "</div>";
                      if(!product.IsBooked) {
                      content += "<input style='margin:10px' class='col btn btn-primary' type='button' value='Book' onclick=\"bookProduct(\'Hotel\',"+ product.Id + ")\" >"; 
                    }
                    else {
                      content += "<input style='margin:10px;' class='col btn btn-primary' type='button' value='Booked' onclick=\"bookProduct(\'Hotel\',"+ product.Id + ")\" disabled>"; 
                    }
                    if(!product.IsSaved) {
                      content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Save' onclick=\"saveProduct('Hotel',"+ product.Id + ")\">";
                    }
                    else {
                     content += "<input style='margin:10px' class='col btn btn-success' type='button' value='Saved' onclick=\"saveProduct(\'Hotel\',"+ product.Id + ")\" disabled>";
                    }
                "</div>" +
            "</div>"
            resultSection.innerHTML += content; 
      });
    }
  };
  xhttp.open("GET", "http://localhost:51597/Products/Hotel", true);
  xhttp.send();
}

</script>
</head>
<body>
    <nav class="navbar navbar-expand-sm bg-info navbar-dark">
                <ul class="navbar-nav">
                  <li onclick="getAirList()" class="nav-item active">
                    <a class="nav-link" href="#"><h2>Air</h2></a>
                  </li>
                  <li onclick="getActivityList()" class="nav-item active">
                    <a class="nav-link" href="#"><h2>Activity</h2></a>
                  </li>
                  <li onclick="getHotelList()" class="nav-item active">
                    <a class="nav-link" href="#"><h2>Hotel</h2></a>
                  </li>
                  <li onclick="getCarList()" class="nav-item active">
                    <a class="nav-link" href="#"><h2>Car</h2></a>
                  </li>
                </ul>
              </nav>
<div id="productList" class="container">
</div>
</body>
</html>
